

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Regression in Python &#8212; Cancer OLS Challenge Project Jupyter Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Regression-AnalysisV2';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Data Visualization" href="Data-Visualization.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="Main.html">
  
  
  
  
  
    <p class="title logo__title">Cancer OLS Challenge Project Jupyter Book</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="Main.html">
                    INTRODUCTION
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Analysis Notebooks</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Data-Preparation.html">Data Preparation</a></li>

<li class="toctree-l1"><a class="reference internal" href="Data-Visualization.html">Data Visualization</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Regression in Python</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/UCB-stat-159-s23/project-group10" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/UCB-stat-159-s23/project-group10/issues/new?title=Issue%20on%20page%20%2FRegression-AnalysisV2.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Regression-AnalysisV2.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Regression in Python</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Regression in Python</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrapping">bootstrapping</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="regression-in-python">
<h1>Regression in Python<a class="headerlink" href="#regression-in-python" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">shapefile</span> <span class="k">as</span> <span class="nn">shp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fips_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/fips2county.tsv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s1">&#39;infer&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span>
<span class="n">cancer_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/cancer_reg.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add a new column &#39;Target_div_Income&#39;</span>
<span class="n">cancer_df</span><span class="p">[</span><span class="s1">&#39;Target_div_Income&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cancer_df</span><span class="p">[</span><span class="s1">&#39;TARGET_deathRate&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">cancer_df</span><span class="p">[</span><span class="s1">&#39;medIncome&#39;</span><span class="p">]</span>

<span class="c1"># extract state and county from &#39;Geography&#39; column and create new columns</span>
<span class="n">cancer_df</span><span class="p">[[</span><span class="s1">&#39;County&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">cancer_df</span><span class="p">[</span><span class="s1">&#39;Geography&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(.+), (.+)&#39;</span><span class="p">)</span>
<span class="n">cancer_df</span><span class="p">[</span><span class="s1">&#39;County&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cancer_df</span><span class="p">[</span><span class="s1">&#39;County&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; County&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="c1"># manually change two county names</span>
<span class="n">cancer_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">166</span><span class="p">,</span> <span class="s1">&#39;County&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Dona Ana County&#39;</span>
<span class="n">cancer_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">820</span><span class="p">,</span> <span class="s1">&#39;County&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;La Salle Parish&#39;</span>

<span class="c1"># merge the dataframes to get the FIPS codes</span>
<span class="n">cancer_merge_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">cancer_df</span><span class="p">,</span> <span class="n">fips_df</span><span class="p">,</span>
                     <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;County&#39;</span><span class="p">],</span> <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CountyName&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># add a new column &#39;Target_div_LogIncome&#39;</span>
<span class="n">cancer_merge_df</span><span class="p">[</span><span class="s1">&#39;Target_div_LogIncome&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cancer_merge_df</span><span class="p">[</span><span class="s1">&#39;TARGET_deathRate&#39;</span><span class="p">]</span> <span class="o">/</span> \
                                    <span class="p">(</span><span class="n">cancer_merge_df</span><span class="p">[</span><span class="s1">&#39;medIncome&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>

<span class="n">cancer_merge_df</span>
<span class="c1"># create a new dataframe for graphdata with columns &#39;fips&#39; and &#39;values&#39;</span>
<span class="n">graphdata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;fips&#39;</span><span class="p">:</span> <span class="n">cancer_merge_df</span><span class="p">[</span><span class="s1">&#39;CountyFIPS&#39;</span><span class="p">],</span>
                          <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="n">cancer_merge_df</span><span class="p">[</span><span class="s1">&#39;Target_div_LogIncome&#39;</span><span class="p">],</span>
                          <span class="s1">&#39;CountyFIPS&#39;</span><span class="p">:</span> <span class="n">cancer_merge_df</span><span class="p">[</span><span class="s1">&#39;CountyFIPS&#39;</span><span class="p">]})</span>

<span class="c1"># create a new dataframe newbieLOG with column &#39;anomalies&#39;</span>
<span class="n">newbieLOG</span> <span class="o">=</span> <span class="n">graphdata</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">newbieLOG</span><span class="p">[</span><span class="s1">&#39;anomalies&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">newbieLOG</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">newbieLOG</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">newbieLOG</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">newbieLOG</span><span class="p">[</span><span class="s1">&#39;anomalies&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">newbieLOG</span><span class="p">[</span><span class="s1">&#39;anomalies&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">newbieLOG</span><span class="p">[</span><span class="s1">&#39;anomalies&#39;</span><span class="p">]),</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">newbieLOG</span> <span class="o">=</span> <span class="n">newbieLOG</span><span class="p">[[</span><span class="s1">&#39;fips&#39;</span><span class="p">,</span> <span class="s1">&#39;anomalies&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">state_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Alabama&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;Alaska&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;Arizona&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;Arkansas&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s2">&quot;California&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s2">&quot;Colorado&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
    <span class="s2">&quot;Connecticut&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
    <span class="s2">&quot;Delaware&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s2">&quot;Florida&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
    <span class="s2">&quot;Georgia&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s2">&quot;Hawaii&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
    <span class="s2">&quot;Idaho&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
    <span class="s2">&quot;Illinois&quot;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
    <span class="s2">&quot;Indiana&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
    <span class="s2">&quot;Iowa&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
    <span class="s2">&quot;Kansas&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
    <span class="s2">&quot;Kentucky&quot;</span><span class="p">:</span> <span class="mi">17</span><span class="p">,</span>
    <span class="s2">&quot;Louisiana&quot;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span>
    <span class="s2">&quot;Maine&quot;</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span>
    <span class="s2">&quot;Maryland&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="s2">&quot;Massachusetts&quot;</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span>
    <span class="s2">&quot;Michigan&quot;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span>
    <span class="s2">&quot;Minnesota&quot;</span><span class="p">:</span> <span class="mi">23</span><span class="p">,</span>
    <span class="s2">&quot;Mississippi&quot;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
    <span class="s2">&quot;Missouri&quot;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span>
    <span class="s2">&quot;Montana&quot;</span><span class="p">:</span> <span class="mi">26</span><span class="p">,</span>
    <span class="s2">&quot;Nebraska&quot;</span><span class="p">:</span> <span class="mi">27</span><span class="p">,</span>
    <span class="s2">&quot;Nevada&quot;</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span>
    <span class="s2">&quot;New Hampshire&quot;</span><span class="p">:</span> <span class="mi">29</span><span class="p">,</span>
    <span class="s2">&quot;New Jersey&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
    <span class="s2">&quot;New Mexico&quot;</span><span class="p">:</span> <span class="mi">31</span><span class="p">,</span>
    <span class="s2">&quot;New York&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
    <span class="s2">&quot;North Carolina&quot;</span><span class="p">:</span> <span class="mi">33</span><span class="p">,</span>
    <span class="s2">&quot;North Dakota&quot;</span><span class="p">:</span> <span class="mi">34</span><span class="p">,</span>
    <span class="s2">&quot;Ohio&quot;</span><span class="p">:</span> <span class="mi">35</span><span class="p">,</span>
    <span class="s2">&quot;Oklahoma&quot;</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span>
    <span class="s2">&quot;Oregon&quot;</span><span class="p">:</span> <span class="mi">37</span><span class="p">,</span>
    <span class="s2">&quot;Pennsylvania&quot;</span><span class="p">:</span> <span class="mi">38</span><span class="p">,</span>
    <span class="s2">&quot;Rhode Island&quot;</span><span class="p">:</span> <span class="mi">39</span><span class="p">,</span>
    <span class="s2">&quot;South Carolina&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
    <span class="s2">&quot;South Dakota&quot;</span><span class="p">:</span> <span class="mi">41</span><span class="p">,</span>
    <span class="s2">&quot;Tennessee&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
    <span class="s2">&quot;Texas&quot;</span><span class="p">:</span> <span class="mi">43</span><span class="p">,</span>
    <span class="s2">&quot;Utah&quot;</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span>
    <span class="s2">&quot;Vermont&quot;</span><span class="p">:</span> <span class="mi">45</span><span class="p">,</span>
    <span class="s2">&quot;Virginia&quot;</span><span class="p">:</span> <span class="mi">46</span><span class="p">,</span>
    <span class="s2">&quot;Washington&quot;</span><span class="p">:</span> <span class="mi">47</span><span class="p">,</span>
    <span class="s2">&quot;West Virginia&quot;</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span>
    <span class="s2">&quot;Wisconsin&quot;</span><span class="p">:</span> <span class="mi">49</span><span class="p">,</span>
    <span class="s2">&quot;Wyoming&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
    <span class="s2">&quot;District of Columbia&quot;</span><span class="p">:</span> <span class="mi">51</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cancer_int_df</span> <span class="o">=</span> <span class="n">cancer_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;binnedInc&#39;</span><span class="p">,</span> <span class="s1">&#39;Geography&#39;</span><span class="p">,</span> <span class="s1">&#39;County&#39;</span><span class="p">])</span>
<span class="n">cancer_int_df</span> <span class="o">=</span> <span class="n">cancer_int_df</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s2">&quot;State&quot;</span><span class="p">:</span> <span class="n">state_dict</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moddat</span> <span class="o">=</span> <span class="n">cancer_int_df</span>
<span class="p">(</span><span class="n">moddat</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">*</span><span class="mi">100</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>avgAnnCount                 0.000000
avgDeathsPerYear            0.000000
TARGET_deathRate            0.000000
incidenceRate               0.000000
medIncome                   0.000000
popEst2015                  0.000000
povertyPercent              0.000000
studyPerCap                 0.000000
MedianAge                   0.000000
MedianAgeMale               0.000000
MedianAgeFemale             0.000000
AvgHouseholdSize            0.000000
PercentMarried              0.000000
PctNoHS18_24                0.000000
PctHS18_24                  0.000000
PctSomeCol18_24            74.991795
PctBachDeg18_24             0.000000
PctHS25_Over                0.000000
PctBachDeg25_Over           0.000000
PctEmployed16_Over          4.988513
PctUnemployed16_Over        0.000000
PctPrivateCoverage          0.000000
PctPrivateCoverageAlone    19.986872
PctEmpPrivCoverage          0.000000
PctPublicCoverage           0.000000
PctPublicCoverageAlone      0.000000
PctWhite                    0.000000
PctBlack                    0.000000
PctAsian                    0.000000
PctOtherRace                0.000000
PctMarriedHouseholds        0.000000
BirthRate                   0.000000
Target_div_Income           0.000000
State                       0.000000
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Since PctSomeCol18_24 has a NA rate of 74.99%, and represents the inbetween between high
school diploma and bachelors, we can justify excluding it.
PctEmployed16_Over has only a 4.99% NA rate, and PctPublicCoverageAlone, which is the
percentage of county residents with government-provided health coverage alone, has a 19.99%
NA rate, but seems too important to ignore if we wish to consider the status of coverage as a
variable(s).
Let us do MICE (Multiple Imputation by Chained Equations) to replace these NA values with
very likely substitutions. MICE operates under the assumption that the data missing is MAR
(Missing at Random).
Due to the data collection process (each row represents a county), the likely possible bias is
that certain states refuse or fail to collect these variables in a systematic way, and thus the
data is no longer MAR. We will check this assumption towards the end of the modelling by
considering our finalized model on both the imputated and original dataset (rows including
NA’s will be removed), and assess their similarities. Regardless, modelling will be done using
the imputed dataset, assuming MAR.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop the 18th column from the dataframe</span>
<span class="n">trim</span> <span class="o">=</span> <span class="n">moddat</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;PctSomeCol18_24&#39;</span><span class="p">])</span>

<span class="kn">from</span> <span class="nn">sklearn.experimental</span> <span class="kn">import</span> <span class="n">enable_iterative_imputer</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">IterativeImputer</span>

<span class="c1"># create an instance of the imputer class</span>
<span class="n">imputer</span> <span class="o">=</span> <span class="n">IterativeImputer</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># fit the imputer on the data</span>
<span class="n">imputer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trim</span><span class="p">)</span>

<span class="c1"># impute the missing values</span>
<span class="n">imputed_data</span> <span class="o">=</span> <span class="n">imputer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">trim</span><span class="p">)</span>

<span class="c1"># convert the imputed data to a pandas DataFrame</span>
<span class="n">imputed_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">imputed_data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">trim</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Initial variable selection for our model will be informed by domain knowledge and insight gained from prior visualization of the data.</p>
<p>Literature on socioeconomic factors affecting cancer mortality point to poverty, education, and race as some of the most important factors. In the 2017 paper “Socioeconomic and Racial/Ethnic Disparities in Cancer Mortality, Incidence, and Survival in the United States, 1950–2014: Over Six Decades of Changing Patterns and Widening Inequalities,” the authors concluded that individuals in lower income and education groups had significantly higher mortality and incidence rates. The authors also noted that Blacks had significantly higher mortality and incidence rates than other races. In the 2021 paper “Leading cancers contributing to educational disparities in cancer mortality in the US, 2017,” the authors concluded that there was a significant difference between the mortality rate between individuals with a bachelors degree and higher, and all education levels below that. Since both these studies use data exclusively from the U.S., and are within the the time frame of interest to us, we are comfortable using these conclusions to guide our variable selection.</p>
<p>The visualizations of our own data support these conclusions as well as suggest a categorical variable indicating whether a given county is in the Southwest region.</p>
<p>Additionally, the conclusions from the second paper suggest two new variables, <strong>PctNoHS18_24</strong> and <strong>PctHS18_24</strong>, which represent thepercent of county residents ages 18-24 whose highest education attained is less than a high school degree, and then a high school degree, respectively. While there are several other variables related to educational goals, such as percentage of county residents ages 18-24 who have attained a bachelors, the literature above suggests that residents with lower educational achievements have a higher cancer mortality, while the opposite is not necessarily true.</p>
<p>The variables for the initial model will be povertyPercent (Percent of populace in poverty), PctBlack, and PctNoHS18 and PctHS18_24. For future investigation we will consider isSouthEast (a categorical variable created later), as well as the variables related to healthcare coverage (<strong>PctPrivateCoverage, PctPrivateCoverageAlone, PctEmpPrivCoverage, PctPublicCoverage, PctPubliceCoverageAlone).</strong></p>
<p>Firstly, let us examine the variables selected to see if any transformations would be appropriate.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imputed_new</span> <span class="o">=</span> <span class="n">imputed_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># create a copy of imputed</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># import the matplotlib library for plotting</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">imputed_new</span><span class="p">[</span><span class="s1">&#39;povertyPercent&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histogram of imputed_new$povertyPercent&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;imputed_new$povertyPercent&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">imputed_new</span><span class="p">[</span><span class="s1">&#39;PctBlack&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histogram of imputed_new$povertyPercent&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;imputed_new$PctBlack&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5d81c9abd8285f3df860cd7e9ef4629fac1de758c359e91647462113d0749ecc.png" src="_images/5d81c9abd8285f3df860cd7e9ef4629fac1de758c359e91647462113d0749ecc.png" />
<img alt="_images/2e7335d298613a1deb24f51a9371522f2fc03dec25fb61ec9eefff8d918bfb68.png" src="_images/2e7335d298613a1deb24f51a9371522f2fc03dec25fb61ec9eefff8d918bfb68.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sklearn.linear_model</span> <span class="k">as</span> <span class="nn">lm</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;TARGET_deathRate ~ povertyPercent + PctBlack + PctNoHS18_24 + PctHS18_24&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">imputed_new</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:       TARGET_deathRate   R-squared:                       0.240
Model:                            OLS   Adj. R-squared:                  0.239
Method:                 Least Squares   F-statistic:                     240.4
Date:                Thu, 04 May 2023   Prob (F-statistic):          1.39e-179
Time:                        18:38:58   Log-Likelihood:                -14031.
No. Observations:                3047   AIC:                         2.807e+04
Df Residuals:                    3042   BIC:                         2.810e+04
Df Model:                           4                                         
Covariance Type:            nonrobust                                         
==================================================================================
                     coef    std err          t      P&gt;|t|      [0.025      0.975]
----------------------------------------------------------------------------------
Intercept        127.5873      2.110     60.481      0.000     123.451     131.724
povertyPercent     1.6696      0.083     20.087      0.000       1.507       1.833
PctBlack           0.1364      0.035      3.869      0.000       0.067       0.206
PctNoHS18_24      -0.1734      0.057     -3.058      0.002      -0.285      -0.062
PctHS18_24         0.7090      0.049     14.518      0.000       0.613       0.805
==============================================================================
Omnibus:                      156.436   Durbin-Watson:                   1.569
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              507.276
Skew:                          -0.170   Prob(JB):                    7.02e-111
Kurtosis:                       4.970   Cond. No.                         217.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<p>The initial fit is rather weak, with a R-squared of 0.24. Let us code and add isSoutheast as a categorical variable. To define which states belong to the Southeast, we will be using the regions specified by the Bureau of Economic Analysis, who divide the United States into 8 regions. Finally, we will use ANOVA to discern whether this suggested categorical variable is significant to our regression.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Southeast</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Alabama&quot;</span><span class="p">,</span> <span class="s2">&quot;Arkansas&quot;</span><span class="p">,</span> <span class="s2">&quot;Florida&quot;</span><span class="p">,</span> <span class="s2">&quot;Georgia&quot;</span><span class="p">,</span> <span class="s2">&quot;Kentucky&quot;</span><span class="p">,</span> <span class="s2">&quot;Louisiana&quot;</span><span class="p">,</span> <span class="s2">&quot;Mississippi&quot;</span><span class="p">,</span> <span class="s2">&quot;North Carolina&quot;</span><span class="p">,</span> <span class="s2">&quot;South Carolina&quot;</span><span class="p">,</span> <span class="s2">&quot;Tennessee&quot;</span><span class="p">,</span> <span class="s2">&quot;Virginia&quot;</span><span class="p">,</span> <span class="s2">&quot;West Virginia&quot;</span><span class="p">]</span>
<span class="n">Southeast_int</span> <span class="o">=</span> <span class="p">[</span><span class="n">state_dict</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Southeast</span><span class="p">]</span>
<span class="n">Southeast_int</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 4, 9, 10, 17, 18, 24, 33, 40, 42, 46, 48]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imputed_new</span><span class="p">[</span><span class="s1">&#39;isSoutheast&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">imputed_new</span><span class="p">[</span><span class="s1">&#39;State&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">Southeast_int</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">imputed_new</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>avgAnnCount</th>
      <th>avgDeathsPerYear</th>
      <th>TARGET_deathRate</th>
      <th>incidenceRate</th>
      <th>medIncome</th>
      <th>popEst2015</th>
      <th>povertyPercent</th>
      <th>studyPerCap</th>
      <th>MedianAge</th>
      <th>MedianAgeMale</th>
      <th>...</th>
      <th>PctPublicCoverageAlone</th>
      <th>PctWhite</th>
      <th>PctBlack</th>
      <th>PctAsian</th>
      <th>PctOtherRace</th>
      <th>PctMarriedHouseholds</th>
      <th>BirthRate</th>
      <th>Target_div_Income</th>
      <th>State</th>
      <th>isSoutheast</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1397.000000</td>
      <td>469.0</td>
      <td>164.9</td>
      <td>489.800000</td>
      <td>61898.0</td>
      <td>260131.0</td>
      <td>11.2</td>
      <td>499.748204</td>
      <td>39.3</td>
      <td>36.9</td>
      <td>...</td>
      <td>14.0</td>
      <td>81.780529</td>
      <td>2.594728</td>
      <td>4.821857</td>
      <td>1.843479</td>
      <td>52.856076</td>
      <td>6.118831</td>
      <td>0.002664</td>
      <td>47.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>173.000000</td>
      <td>70.0</td>
      <td>161.3</td>
      <td>411.600000</td>
      <td>48127.0</td>
      <td>43269.0</td>
      <td>18.6</td>
      <td>23.111234</td>
      <td>33.0</td>
      <td>32.2</td>
      <td>...</td>
      <td>15.3</td>
      <td>89.228509</td>
      <td>0.969102</td>
      <td>2.246233</td>
      <td>3.741352</td>
      <td>45.372500</td>
      <td>4.333096</td>
      <td>0.003352</td>
      <td>47.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>102.000000</td>
      <td>50.0</td>
      <td>174.7</td>
      <td>349.700000</td>
      <td>49348.0</td>
      <td>21026.0</td>
      <td>14.6</td>
      <td>47.560164</td>
      <td>45.0</td>
      <td>44.0</td>
      <td>...</td>
      <td>21.1</td>
      <td>90.922190</td>
      <td>0.739673</td>
      <td>0.465898</td>
      <td>2.747358</td>
      <td>54.444868</td>
      <td>3.729488</td>
      <td>0.003540</td>
      <td>47.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>427.000000</td>
      <td>202.0</td>
      <td>194.8</td>
      <td>430.400000</td>
      <td>44243.0</td>
      <td>75882.0</td>
      <td>17.1</td>
      <td>342.637253</td>
      <td>42.8</td>
      <td>42.2</td>
      <td>...</td>
      <td>25.0</td>
      <td>91.744686</td>
      <td>0.782626</td>
      <td>1.161359</td>
      <td>1.362643</td>
      <td>51.021514</td>
      <td>4.603841</td>
      <td>0.004403</td>
      <td>47.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>57.000000</td>
      <td>26.0</td>
      <td>144.4</td>
      <td>350.100000</td>
      <td>49955.0</td>
      <td>10321.0</td>
      <td>12.5</td>
      <td>0.000000</td>
      <td>48.3</td>
      <td>47.8</td>
      <td>...</td>
      <td>22.7</td>
      <td>94.104024</td>
      <td>0.270192</td>
      <td>0.665830</td>
      <td>0.492135</td>
      <td>54.027460</td>
      <td>6.796657</td>
      <td>0.002891</td>
      <td>47.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3042</th>
      <td>1962.667684</td>
      <td>15.0</td>
      <td>149.6</td>
      <td>453.549422</td>
      <td>46961.0</td>
      <td>6343.0</td>
      <td>12.4</td>
      <td>0.000000</td>
      <td>44.2</td>
      <td>41.1</td>
      <td>...</td>
      <td>13.2</td>
      <td>90.280811</td>
      <td>3.837754</td>
      <td>0.327613</td>
      <td>1.700468</td>
      <td>51.063830</td>
      <td>7.773512</td>
      <td>0.003186</td>
      <td>16.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3043</th>
      <td>1962.667684</td>
      <td>43.0</td>
      <td>150.1</td>
      <td>453.549422</td>
      <td>48609.0</td>
      <td>37118.0</td>
      <td>18.8</td>
      <td>377.175494</td>
      <td>30.4</td>
      <td>29.3</td>
      <td>...</td>
      <td>17.7</td>
      <td>75.706245</td>
      <td>2.326771</td>
      <td>4.044920</td>
      <td>14.130288</td>
      <td>52.007937</td>
      <td>8.186470</td>
      <td>0.003088</td>
      <td>16.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3044</th>
      <td>1962.667684</td>
      <td>46.0</td>
      <td>153.9</td>
      <td>453.549422</td>
      <td>51144.0</td>
      <td>34536.0</td>
      <td>15.0</td>
      <td>1968.959926</td>
      <td>30.9</td>
      <td>30.5</td>
      <td>...</td>
      <td>16.8</td>
      <td>87.961629</td>
      <td>2.313188</td>
      <td>1.316472</td>
      <td>5.680705</td>
      <td>55.153949</td>
      <td>7.809192</td>
      <td>0.003009</td>
      <td>16.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3045</th>
      <td>1962.667684</td>
      <td>52.0</td>
      <td>175.0</td>
      <td>453.549422</td>
      <td>50745.0</td>
      <td>25609.0</td>
      <td>13.3</td>
      <td>0.000000</td>
      <td>39.0</td>
      <td>36.9</td>
      <td>...</td>
      <td>14.0</td>
      <td>92.905681</td>
      <td>1.176562</td>
      <td>0.244632</td>
      <td>2.131790</td>
      <td>58.484232</td>
      <td>7.582938</td>
      <td>0.003449</td>
      <td>16.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3046</th>
      <td>1962.667684</td>
      <td>48.0</td>
      <td>213.6</td>
      <td>453.549422</td>
      <td>41193.0</td>
      <td>37030.0</td>
      <td>13.9</td>
      <td>0.000000</td>
      <td>26.2</td>
      <td>25.5</td>
      <td>...</td>
      <td>12.6</td>
      <td>70.098132</td>
      <td>16.590100</td>
      <td>3.177753</td>
      <td>1.356457</td>
      <td>56.040242</td>
      <td>8.981723</td>
      <td>0.005185</td>
      <td>16.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>3047 rows × 34 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model1</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;TARGET_deathRate ~ povertyPercent + PctBlack + PctNoHS18_24 + PctHS18_24 + isSoutheast&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">imputed_new</span><span class="p">)</span>
<span class="n">result1</span> <span class="o">=</span> <span class="n">model1</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">result1</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:       TARGET_deathRate   R-squared:                       0.267
Model:                            OLS   Adj. R-squared:                  0.266
Method:                 Least Squares   F-statistic:                     221.6
Date:                Thu, 04 May 2023   Prob (F-statistic):          4.65e-202
Time:                        18:38:59   Log-Likelihood:                -13976.
No. Observations:                3047   AIC:                         2.796e+04
Df Residuals:                    3041   BIC:                         2.800e+04
Df Model:                           5                                         
Covariance Type:            nonrobust                                         
==================================================================================
                     coef    std err          t      P&gt;|t|      [0.025      0.975]
----------------------------------------------------------------------------------
Intercept        130.1146      2.086     62.374      0.000     126.024     134.205
povertyPercent     1.4814      0.084     17.726      0.000       1.318       1.645
PctBlack          -0.0416      0.039     -1.080      0.280      -0.117       0.034
PctNoHS18_24      -0.1066      0.056     -1.902      0.057      -0.217       0.003
PctHS18_24         0.6219      0.049     12.776      0.000       0.526       0.717
isSoutheast       11.9612      1.133     10.556      0.000       9.739      14.183
==============================================================================
Omnibus:                      141.721   Durbin-Watson:                   1.604
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              433.480
Skew:                          -0.154   Prob(JB):                     7.43e-95
Kurtosis:                       4.822   Cond. No.                         219.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<p>To add variables of interest, we will be using Lasso regression using a Lambda 1 standard deviation away from the minimum residual deviance Lambda value, which will be obtained using cross-validation. Here is the graph of Lambda values, with the minimum Lambda at 0.1434, and the 1 SE Lambda value at 2.1288.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LassoCV</span>


<span class="n">y</span> <span class="o">=</span> <span class="n">imputed_new</span><span class="p">[</span><span class="s1">&#39;TARGET_deathRate&#39;</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">imputed_new</span><span class="p">[[</span><span class="s1">&#39;povertyPercent&#39;</span><span class="p">,</span> <span class="s1">&#39;PctBlack&#39;</span><span class="p">,</span> <span class="s1">&#39;PctHS18_24&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;PctNoHS18_24&#39;</span><span class="p">,</span> <span class="s1">&#39;isSoutheast&#39;</span><span class="p">,</span><span class="s1">&#39;PctPublicCoverage&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;PctPublicCoverageAlone&#39;</span><span class="p">,</span> <span class="s2">&quot;PctUnemployed16_Over&quot;</span><span class="p">]]</span>

<span class="n">modelcvalpha</span> <span class="o">=</span> <span class="n">LassoCV</span><span class="p">(</span><span class="n">alphas</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">max_iter</span> <span class="o">=</span> <span class="mi">100000</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">modelcvalpha</span><span class="p">,</span> <span class="s1">&#39;alpha_&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">newmodel</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
<span class="n">newmodel</span> <span class="o">=</span> <span class="n">newmodel</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">coefs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">newmodel</span><span class="p">,</span> <span class="s1">&#39;coef_&#39;</span><span class="p">)</span>
<span class="n">coefs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 6.18181993e-01,  6.51711241e-04,  4.98726850e-01, -1.89012910e-01,
        1.07662463e+01,  3.04999629e-01,  6.05695117e-01,  5.43496705e-01])
</pre></div>
</div>
</div>
</div>
</section>
<section id="bootstrapping">
<h1>bootstrapping<a class="headerlink" href="#bootstrapping" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a function to calculate the coefficients using the bootstrap</span>
<span class="k">def</span> <span class="nf">bootstrap_model</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">data_boot</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;TARGET_deathRate ~ povertyPercent + PctHS18_24 + isSoutheast + PctPublicCoverage + PctPublicCoverageAlone + PctUnemployed16_Over&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data_boot</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

<span class="n">povertyPercent</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">PctHS18_24</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">isSoutheast</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">PctPublicCoverage</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">PctPublicCoverageAlone</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">PctUnemployed16_Over</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">bootparams</span> <span class="o">=</span> <span class="n">bootstrap_model</span><span class="p">(</span><span class="n">imputed_new</span><span class="p">)</span>
    <span class="n">povertyPercent</span> <span class="o">+=</span> <span class="p">[</span><span class="n">bootparams</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">PctHS18_24</span> <span class="o">+=</span> <span class="p">[</span><span class="n">bootparams</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">isSoutheast</span> <span class="o">+=</span> <span class="p">[</span><span class="n">bootparams</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
    <span class="n">PctPublicCoverage</span> <span class="o">+=</span> <span class="p">[</span><span class="n">bootparams</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
    <span class="n">PctPublicCoverageAlone</span> <span class="o">+=</span> <span class="p">[</span><span class="n">bootparams</span><span class="p">[</span><span class="mi">4</span><span class="p">]]</span>
    <span class="n">PctUnemployed16_Over</span> <span class="o">+=</span> <span class="p">[</span><span class="n">bootparams</span><span class="p">[</span><span class="mi">5</span><span class="p">]]</span>
    
<span class="n">orig_params</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;TARGET_deathRate ~ povertyPercent + PctHS18_24 + isSoutheast + PctPublicCoverage + PctPublicCoverageAlone + PctUnemployed16_Over&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">imputed_new</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#make df of results</span>

<span class="n">bootdf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;povertyPercent&#39;</span><span class="p">:</span> <span class="n">povertyPercent</span><span class="p">,</span>
                       <span class="s1">&#39;PctHS18_24&#39;</span><span class="p">:</span> <span class="n">PctHS18_24</span><span class="p">,</span>
                       <span class="s1">&#39;isSoutheast&#39;</span><span class="p">:</span> <span class="n">isSoutheast</span><span class="p">,</span>
                       <span class="s1">&#39;PctPublicCoverage&#39;</span><span class="p">:</span> <span class="n">PctPublicCoverage</span><span class="p">,</span>
                       <span class="s1">&#39;PctPublicCoverageAlone&#39;</span><span class="p">:</span> <span class="n">PctPublicCoverageAlone</span><span class="p">,</span>
                       <span class="s1">&#39;PctUnemployed16_Over&#39;</span><span class="p">:</span> <span class="n">PctUnemployed16_Over</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot SBS hists of vars in df</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bootdf</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">bootdf</span><span class="p">[</span><span class="n">bootdf</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="mf">2.5</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">bootdf</span><span class="p">[</span><span class="n">bootdf</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="mf">97.5</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">orig_params</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">bootdf</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">bootdf</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/247b342c230c86a520b6168201ac1c3b330d86b8d9f212a05f71c03d7d5574a0.png" src="_images/247b342c230c86a520b6168201ac1c3b330d86b8d9f212a05f71c03d7d5574a0.png" />
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Data-Visualization.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Data Visualization</p>
      </div>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Regression in Python</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bootstrapping">bootstrapping</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Danielle Killeen, Didi Duan, Noah Tran, Brandon Rodriguez, Jiayi Qiu
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>